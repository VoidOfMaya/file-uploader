<section id="user-info">
    <h3>welcome <%= user.firstName %></h3><a href="/auth/logout">logout</a>
</section>

<section id="storage-container">
    <% if(folders){ %>   
        <% folders.forEach(folder => { %>
            <div class="folder-Btn storage-Btn">
                <img src="/icons/folder-solid-full.svg" 
                    alt="folder" 
                    width="50" 
                    height="50">
                <div style="white-space: nowarp; text-overflow: ellipsis;  overflow: hidden;" ><%= folder.name %> </div>
                <form method="get" action="/folders/<%= folder.id %>">
                    <button>view</button>                    
                </form> 

                <button>delete</button> 
            </div> 
        
        <% })%>
    <% } %>
    <%if(files){%> 
        <% files.forEach(file => { %>
                <div class="file-Btn storage-Btn">
                    <img src="/icons/file-solid-full.svg" 
                        alt="folder" 
                        width="50" 
                        height="50">
                    <div style="white-space: nowarp; text-overflow: ellipsis; overflow: hidden;"><%= file.originalName %></div> 
                    <button>edit</button>
                    <button>delete</button> 
                <!-- following fields should be displayed in an about file dialog
                <%= file.mimeType %>  
                <%= Math.round((file.size/ 1024)* 100)/100 %>Kb 
                <%= file.uploadTime %>
                --> 
                </div>            
        <% }) %>
    <% }else { %>
        <p>your storage is empty!</p>
    <% } %>
        
</section>

<section id="storage-creation">
    <form action="/upload/file" method="post" enctype="multipart/form-data">
    <input type="file" id="upFile" name="upFile"  style="display: none;"/>
    <label for="upFile">
    <img src="/icons/plus-thick.svg" alt="add file" width="50" height="50">    
    </label>

    <button>Upload</button>
    </form>
    <button id="show-folder-creation-dialog" type="button">create Folder</button>
</section>

<dialog id="create-folder-dialog">
    <form method="post" action="/folders/new">
        <label for="folderName">Folder name: </label>
        <input name="folderName" type="text" min="1" max="20" required/>
        <button id="create-folder-btn">Create</button>
    </form>
    <button type="button" id="cancel-dialog">cancel</button>
</dialog>

<script>
    const openDialog = document.getElementById('show-folder-creation-dialog');
    const dialog = document.getElementById('create-folder-dialog');
    const submitBtn = document.getElementById('create-folder-btn');
    const cancelBtn = document.getElementById('cancel-dialog');

    openDialog.addEventListener('click',()=>{
        dialog.showModal();
    })

    submitBtn.addEventListener('click',()=>{
        dialog.close();
    })
    cancelBtn.addEventListener('click',()=>{
        dialog.close();
    })

</script>